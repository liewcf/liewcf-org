---
import { getCollection } from 'astro:content';
import ContactCTA from '../../components/ContactCTA.astro';
import Hero from '../../components/Hero.astro';
import BaseLayout from '../../layouts/BaseLayout.astro';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf()
);
---

<BaseLayout title="Blog | Liew CheonFong" description="Notes on building and shipping">
	<div class="stack gap-20">
		<main class="wrapper stack gap-8">
			<Hero
				title="Blog"
				tagline="Notes on building, shipping, and staying focused."
				align="start"
			/>
			<ul class="post-list">
				{
					posts.map((post) => (
						<li>
							<a class="post-card" href={`/blog/${post.id}`}>
								<div>
									<h2>{post.data.title}</h2>
									<p>{post.data.description}</p>
								</div>
								<span class="post-meta">
									{post.data.publishDate.toLocaleDateString('en-US', {
										year: 'numeric',
										month: 'short',
										day: 'numeric',
									})}
								</span>
							</a>
						</li>
					))
				}
			</ul>
		</main>
		<ContactCTA />
	</div>
</BaseLayout>

<style>
	.post-list {
		list-style: none;
		padding: 0;
		margin: 0;
		display: grid;
		gap: 1.5rem;
	}

	.post-card {
		display: flex;
		flex-direction: column;
		gap: 1rem;
		padding: 1.5rem;
		border-radius: 1.5rem;
		border: 1px solid var(--gray-800);
		background: var(--gradient-subtle);
		text-decoration: none;
		color: var(--gray-300);
		box-shadow: var(--shadow-sm);
		transition: box-shadow var(--theme-transition);
	}

	.post-card:hover {
		box-shadow: var(--shadow-md);
	}

	.post-card h2 {
		margin: 0 0 0.5rem;
		color: var(--gray-0);
		font-size: var(--text-xl);
	}

	.post-card p {
		margin: 0;
	}

	.post-meta {
		font-size: var(--text-sm);
		color: var(--gray-400);
	}
</style>
